{"code":"!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=0)}([function(e,t,n){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n(1);var r=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.game,this.canvas,this.globalTimer,this.resourcesDisplay}var t,n,r;return t=e,(n=[{key:\"initialize\",value:function(){this.game=new Clempire,this.game.load.then(function(){window.addEventListener(\"resize\",this.resizeHandler(),!0),this.drawGame(),this.displayResources(),this.startGame()}.bind(this))}},{key:\"resizeHandler\",value:function(){var e={session:this,delta:100,timeout:!1};return function(){console.log(e),e.rtime=new Date,e.timeout||(e.timeout=!0,setTimeout(e.session.resizeEnd.bind(e),e.delta))}}},{key:\"resizeEnd\",value:function(){console.log(this),new Date-this.rtime<this.delta?setTimeout(this.session.resizeEnd.bind(this),this.delta):(this.timeout=!1,this.session.drawGame.apply(this.session))}},{key:\"drawGame\",value:function(){this.canvas=document.getElementById(\"mainCanvas\");var e=document.getElementById(\"left-side\");this.canvas.width=e.offsetWidth,this.canvas.height=e.offsetHeight,this.displaySources(),this.displayBuildings()}},{key:\"startGame\",value:function(){this.globalTimer=setInterval(this.tick.bind(this),200)}},{key:\"tick\",value:function(){this.updateResources()}},{key:\"displaySources\",value:function(){var e=this,t=this.canvas.getContext(\"2d\");this.placeResourceAnchors();var n=document.getElementsByClassName(\"resource-field\"),i=0,r=this.canvas.height/(n.length+1),s=function(s){if(i===n.length)throw new Error(\"Not enogh resource fields!\");var a=new Image;a.onload=function(){t.drawImage(a,0,0,a.width,a.height,.5*this.canvas.width-85,this.topGridSize*(this.counter+1)-85,170,170)}.bind({canvas:e.canvas,counter:i,topGridSize:r}),a.src=e.game.sourcesData[s].img,n[i].onclick=e.game.fieldClick.bind(e.game.sourcesData[s]),i++};for(var a in this.game.sourcesData)s(a)}},{key:\"placeResourceAnchors\",value:function(){for(var e=1,t=this.game.sourcesData.length,n=document.getElementById(\"anchors\");n.firstChild;)n.removeChild(n.firstChild);for(var i in this.game.sourcesData){var r=document.createElement(\"div\");r.classList.add(\"resource-field-anchor\"),r.setAttribute(\"data-source-field\",e.toString()),r.style.top=\"\".concat(100/(t+1)*e,\"%\"),r.style.left=\"50%\";var s=document.createElement(\"div\");s.classList.add(\"resource-field\"),s.style.cursor=\"url(\".concat(this.game.sourcesData[i].cursor,\"), pointer\"),r.appendChild(s),n.appendChild(r),e++}}},{key:\"displayResources\",value:function(){for(this.resourcesDisplay=document.querySelector(\"#resources ul\");this.resourcesDisplay.firstChild;)this.resourcesDisplay.removeChild(this.resourcesDisplay.firstChild);for(var e in this.game.resourcesData){var t=document.createElement(\"li\"),n=document.createElement(\"div\");n.style.background=\"url(\".concat(this.game.resourcesData[e].icon,\")  no-repeat\"),t.appendChild(n);var i=document.createElement(\"span\");i.classList.add(\"resource-count\"),t.appendChild(i),t.setAttribute(\"data-resource\",e),this.resourcesDisplay.appendChild(t)}}},{key:\"displayBuildings\",value:function(){for(this.buildingsDisplay=document.getElementById(\"buildings\");this.buildingsDisplay.firstChild;)this.buildingsDisplay.removeChild(this.buildingsDisplay.firstChild);for(var e in this.game.buildingsData){var t=document.createElement(\"div\"),n=this.game.buildingsData[e];t.style.background=\"url(\".concat(n.icon,\")  no-repeat\"),t.setAttribute(\"title\",\"\".concat(n.title,\"\\n\\n\").concat(n.description)),this.buildingsDisplay.appendChild(t)}}},{key:\"updateResources\",value:function(){for(var e=0;e<this.resourcesDisplay.children.length;e++){var t=this.resourcesDisplay.children[e];t.getElementsByTagName(\"span\")[0].innerText=this.game.resources.current[t.dataset.resource]}}}])&&i(t.prototype,n),r&&i(t,r),e}());window.addEventListener(\"load\",r.initialize.bind(r),!0)},function(e,t,n){function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,r=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(i=(a=o.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,s=e}finally{try{i||null==o.return||o.return()}finally{if(r)throw s}}return n}(e,t)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()}function r(e,t,n,i,r,s,a){try{var o=e[s](a),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(i,r)}function s(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n(2);var o=function(){function e(t){s(this,e),this.audio=new AudioPlayer,this.load=new Promise(function(e,t){var n=(new Date).getTime();console.log(\"Loading data ...\"),this.loadData().then(function(){for(var t in this.resources={produced:{},gathered:{},current:{}},this.resources)for(var i in this.resourcesData)this.resources[t][i]=0;console.log(\"... done in \".concat((new Date).getTime()-n,\"ms\")),e()}.bind(this))}.bind(this))}var t,n,o;return t=e,(n=[{key:\"loadData\",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(){var t,n,r,s,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=fetch(\"/assets/data/resources.json\").catch(function(e){return console.log(e)}).then(function(e){return e.json()}),n=fetch(\"/assets/data/buildings.json\").catch(function(e){return console.log(e)}).then(function(e){return e.json()}),r=fetch(\"/assets/data/sources.json\").catch(function(e){return console.log(e)}).then(function(e){return e.json()}),e.next=5,Promise.all([t,n,r]);case 5:for(o in s=e.sent,a=i(s,3),this.resourcesData=a[0],this.buildingsData=a[1],this.sourcesData=a[2],this.sourcesData)this.audio.addSound(this.sourcesData[o].id,this.sourcesData[o].sound);case 11:case\"end\":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(i,s){var a=e.apply(t,n);function o(e){r(a,i,s,o,u,\"next\",e)}function u(e){r(a,i,s,o,u,\"throw\",e)}o(void 0)})});return function(){return t.apply(this,arguments)}}()},{key:\"fieldClick\",value:function(){session.game.resources.current[this.id]++,session.game.resources.gathered[this.id]++,session.game.audio.playSound(this.id)}},{key:\"isReqMet\",value:function(e){for(var t in e.resources)for(var n in this.resourcesData)if(!e.resources[t][n]||e.resources[t][n]>this.resources[t][n])return!1;return!0}}])&&a(t.prototype,n),o&&a(t,o),e}();e.exports={Clempire:o,Requirement:function e(){s(this,e),this.resources={produced:{},gathered:{},total:{}}}}},function(e,t){}]);","extractedComments":[]}